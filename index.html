<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Cinder Spires RPG</title>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              // Define custom colors based on the new scheme
              'primary-dark': '#0a0a0a', // Base dark background
              'content-dark': '#111827', // Slightly lighter dark for cards etc. (gray-900)
              'content-medium': '#1f2937', // Medium dark (gray-800)
              'content-light': '#374151', // Lighter dark (gray-700)
              'accent-cyan': '#06b6d4',   // Primary accent (cyan-500)
              'accent-cyan-light': '#22d3ee', // Lighter cyan (cyan-400)
              'accent-cyan-dark': '#0891b2',  // Darker cyan (cyan-600)
              'accent-amber': '#b45309',   // Secondary accent (amber-700)
              'accent-amber-light': '#d97706', // Lighter amber (amber-600)
              'text-main': '#e5e5e5',      // Main text (neutral-200)
              'text-secondary': '#a3a3a3', // Secondary text (neutral-400)
              'text-muted': '#737373',    // Muted text (neutral-500)
            },
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
            },
          }
        }
      }
    </script>

    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a; /* primary-dark */
            color: #e5e5e5; /* text-main */
            overflow-x: hidden;
            margin: 0;
        }
        body::before {
            content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            /* Adjusted gradient and texture opacity */
            background: radial-gradient(ellipse at center, rgba(6, 182, 212, 0.1), rgba(10, 10, 10, 0.5)), url('https://www.transparenttextures.com/patterns/dark-matter.png');
            opacity: 0.2; z-index: -1; pointer-events: none;
        }
        /* Custom Scrollbar with new accent */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; } /* content-medium */
        ::-webkit-scrollbar-thumb { background: #06b6d4; border-radius: 4px; } /* accent-cyan */
        ::-webkit-scrollbar-thumb:hover { background: #0891b2; } /* accent-cyan-dark */
        html { scroll-behavior: smooth; }

        /* Result Box Highlight */
        .result-box strong { color: #22d3ee; } /* accent-cyan-light */

        /* Disclaimer Accent */
        .disclaimer {
            font-size: 0.8rem; color: #a3a3a3; /* text-secondary */
            border-left: 3px solid #06b6d4; /* accent-cyan */
            padding-left: 0.75rem; margin-top: 1rem; font-style: italic;
        }
        /* Active Nav Link Styling */
        .nav-link-active {
             color: #22d3ee; /* accent-cyan-light */
             font-weight: 600;
             background-color: rgba(6, 182, 212, 0.15); /* accent-cyan with low opacity */
        }
        .nav-link-inactive {
            color: #e5e5e5; /* text-main */
        }
        .nav-link-inactive:hover {
            color: #06b6d4; /* accent-cyan */
            background-color: rgba(55, 65, 81, 0.5); /* content-light with opacity */
        }
        /* Placeholder fallback style */
        .placeholder-fallback {
            background-color: #1f2937; /* content-medium */
            color: #a3a3a3; /* text-secondary */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 0.875rem;
            height: 100%; /* Ensure it fills the image container */
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Make React functions available directly
        const { useState, useEffect, useCallback, Fragment } = React;

        // --- Helper Functions ---
        const getAttributeModifier = (attributeValue) => {
            const value = parseInt(attributeValue, 10);
            return isNaN(value) ? 0 : value - 5;
        };
        const roll2d6 = () => {
            const die1 = Math.floor(Math.random() * 6) + 1;
            const die2 = Math.floor(Math.random() * 6) + 1;
            return { total: die1 + die2, rolls: [die1, die2] };
        };
        // Placeholder image error handler
        const handleImageError = (event) => {
            event.target.style.display = 'none'; // Hide the broken image
            // Find the sibling fallback div and display it
            const fallback = event.target.nextElementSibling;
            if (fallback && fallback.classList.contains('placeholder-fallback')) {
                fallback.style.display = 'flex';
            }
        };


        // --- Reusable Components ---
        const Card = ({ children, className = '', aosDelay = "0" }) => (
             <div
                // Updated card styling with new colors
                className={`bg-content-medium/70 border border-accent-amber/40 rounded-lg p-6 shadow-lg transition duration-300 hover:shadow-cyan-500/10 hover:border-accent-amber/60 ${className}`}
                data-aos="fade-up"
                data-aos-delay={aosDelay}
            >
                {children}
            </div>
        );
        const SectionHeading = ({ children }) => (
             // Updated section heading with new accent color
             <h2 className="text-3xl font-bold mb-6 text-accent-cyan-light border-b-2 border-accent-amber/70 pb-2 inline-block">
                {children}
            </h2>
        );
        const CalculatorInput = ({ id, label, type = "number", value, onChange, min, max, step = "1" }) => (
            <div>
                <label htmlFor={id} className="block mb-1 text-sm font-medium text-text-secondary">{label}</label>
                <input
                    type={type}
                    id={id}
                    value={value}
                    onChange={onChange}
                    min={min}
                    max={max}
                    step={step}
                    // Updated input styling
                    className="w-full p-2 rounded bg-content-light border border-content-light focus:border-accent-cyan focus:ring focus:ring-accent-cyan focus:ring-opacity-50 outline-none transition text-text-main"
                />
            </div>
        );
        const CalculatorButton = ({ children, onClick }) => (
            <button
                onClick={onClick}
                // Updated button styling
                className="bg-accent-cyan hover:bg-accent-cyan-dark text-white font-semibold py-2 px-6 rounded-lg shadow transition duration-300 transform hover:scale-105"
            >
                {children}
            </button>
        );
        const ResultBox = ({ children }) => (
            // Updated result box styling
            <div className="result-box mt-6 bg-content-dark/60 border border-accent-cyan/30 p-4 rounded-lg space-y-2 text-text-secondary min-h-[100px]">
                {children}
            </div>
        );
        // Image Component with Placeholder Fallback
        const ImageWithFallback = ({ src, alt, className = '', fallbackText = 'Image' }) => (
            <div className={`relative overflow-hidden ${className}`}>
                <img
                    src={src}
                    alt={alt}
                    className="absolute inset-0 w-full h-full object-cover" // Use absolute positioning
                    onError={handleImageError} // Use the error handler
                />
                {/* Fallback div, initially hidden */}
                <div className="placeholder-fallback" style={{ display: 'none' }}>
                    {fallbackText}
                </div>
            </div>
        );


        // --- Page Components ---
        const HomePage = ({ setCurrentPage }) => (
            <div data-aos="fade-in">
                {/* Hero Section */}
                <section id="hero" className="relative text-center py-24 md:py-32 lg:py-40 min-h-[70vh] flex flex-col justify-center items-center overflow-hidden rounded-lg mb-16 bg-gradient-to-b from-content-dark to-primary-dark">
                    {/* Background Image Placeholder */}
                    <ImageWithFallback
                        src="images/airship.png" // <-- Changed to relative path
                        //src="https://placehold.co/1200x800/111827/374151?text=Airship+Soaring+Above+Spires"
                        alt="Airship soaring above colossal spires piercing the clouds"
                        className="absolute inset-0 w-full h-full opacity-20 z-0"
                        fallbackText="Hero Background"
                    />
                    {/* Content Overlay */}
                    <div className="relative z-10 p-6 rounded-lg bg-primary-dark/50 backdrop-blur-sm">
                        <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold mb-4 text-text-main" data-aos="fade-down" data-aos-delay="200">Welcome to the Skybound Realms</h1>
                        <p className="text-lg md:text-xl max-w-3xl mx-auto mb-8 text-text-secondary" data-aos="fade-up" data-aos-delay="400">
                            Beneath drifting heavens, humanity survives aloft in colossal spires, navigating treacherous skies in majestic airships powered by luminous ether-crystals.
                        </p>
                        <button
                            onClick={() => setCurrentPage('world')}
                            // Updated button colors
                            className="bg-accent-cyan hover:bg-accent-cyan-dark text-white font-semibold py-3 px-8 rounded-lg shadow-lg hover:shadow-xl transition duration-300 transform hover:scale-105" data-aos="zoom-in" data-aos-delay="600">
                            Explore the World
                        </button>
                    </div>
                </section>

                {/* Quick Links/Overview */}
                <section className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
                     <Card aosDelay="100">
                        <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">The World</h3>
                        <p className="text-text-secondary mb-4">Discover the colossal Spires, the perilous Mists, and the factions vying for power.</p>
                        <button onClick={() => setCurrentPage('world')} className="text-accent-cyan hover:text-accent-cyan-light font-semibold">Learn More &rarr;</button>
                    </Card>
                     <Card aosDelay="200">
                        <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Core Rules</h3>
                        <p className="text-text-secondary mb-4">Understand Attributes, Skills, and the fundamental 2d6 check system.</p>
                        <button onClick={() => setCurrentPage('mechanics')} className="text-accent-cyan hover:text-accent-cyan-light font-semibold">Learn More &rarr;</button>
                    </Card>
                     <Card aosDelay="300">
                        <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Archetypes</h3>
                        <p className="text-text-secondary mb-4">Choose your path: Guard, Marine, Scholar, Merchant, or Aeronaut.</p>
                        <button onClick={() => setCurrentPage('archetypes')} className="text-accent-cyan hover:text-accent-cyan-light font-semibold">Learn More &rarr;</button>
                    </Card>
                </section>
            </div>
        );

        const WorldPage = () => (
            <div data-aos="fade-in">
                <SectionHeading>The World of the Spires</SectionHeading>
                <p className="text-lg mb-6 text-text-secondary leading-relaxed">
                    The surface world is lost, claimed long ago by impenetrable mists concealing deadly predators and ancient secrets. Humanity survives aloft, dwelling in colossal spires of stone and crystal that pierce the clouds like the fingers of giants.
                </p>
                <Card className="mb-8" aosDelay="100">
                     <ImageWithFallback
                        src="https://placehold.co/600x300/1f2937/6b7280?text=Colossal+Spire+City"
                        alt="Illustration of a colossal spire reaching high above the clouds, with structures built onto it."
                        className="w-full h-48 rounded-t-lg mb-4"
                        fallbackText="Spire City"
                    />
                    <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">The Spires</h3>
                    <p className="text-text-secondary leading-relaxed">These immense structures are humanity's bastions against the dangers below. Each Spire, or cluster of Spires, forms a city-state with its own culture, laws, and ruling powers. Life is stratified, with the wealthy and powerful residing higher up, while the lower levels teem with industry, trade, and the less fortunate.</p>
                </Card>
                <Card className="mb-8" aosDelay="200">
                     <ImageWithFallback
                        src="https://placehold.co/600x300/111827/4b5563?text=Swirling+Toxic+Mists"
                        alt="Swirling, thick mists obscuring a hidden landscape below."
                        className="w-full h-48 rounded-t-lg mb-4"
                        fallbackText="The Mists"
                    />
                    <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">The Mists</h3>
                    <p className="text-text-secondary leading-relaxed">The swirling, toxic mists that blanket the surface are more than just an environmental hazard. They hide monstrous creatures mutated by strange energies and conceal the ruins of whatever civilization existed before. Venturing into the mists is perilous, often fatal, yet sometimes necessary for resources or forgotten knowledge.</p>
                </Card>
                 <Card className="mb-8" aosDelay="300">
                      <ImageWithFallback
                        src="https://placehold.co/600x300/374151/9ca3af?text=Majestic+Airship+with+Glowing+Crystals"
                        alt="A majestic airship powered by glowing crystals navigating the skies."
                        className="w-full h-48 rounded-t-lg mb-4"
                        fallbackText="Airship"
                    />
                    <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Airships & Ether-Crystals</h3>
                    <p className="text-text-secondary leading-relaxed">Life and commerce depend on majestic airships, powered by luminous ether-crystals mined from deep within the Spires or salvaged from dangerous locations. These vessels range from nimble scouting craft to massive warships and heavily laden merchant barges. Control of the skies means control of trade routes and influence.</p>
                </Card>
                <Card aosDelay="400">
                    <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Factions & Politics</h3>
                    <p className="text-text-secondary leading-relaxed">Powerful Noble Houses engage in covert wars and political maneuvering behind masks of civility. Ambitious Merchant Guilds amass fortunes through cunning negotiation and control of vital resources. Scholarly Orders pursue ancient mysteries, often meddling with forces best left undisturbed. The Spirearch's Guard and Fleet Marines maintain order and defend against external threats, while independent Aeronauts carve their own paths through the boundless skies.</p>
                </Card>
            </div>
        );

        const MechanicsPage = () => (
            <div data-aos="fade-in">
                <SectionHeading>Core Mechanics</SectionHeading>
                <p className="text-lg mb-8 text-text-secondary leading-relaxed">
                    Actions and challenges in The Cinder Spires are resolved using a combination of character attributes, skills, and dice rolls.
                </p>
                <h3 className="text-2xl font-semibold mb-4 text-accent-cyan-light">Core Attributes</h3>
                <p className="mb-6 text-text-secondary">Each character has 7 core attributes, ranging from 1-10. They form the foundation of abilities and influence nearly all checks. The modifier is generally calculated as (Attribute - 5).</p>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                    {/* Updated card text color */}
                    <Card aosDelay="100"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Might</h4><p className="text-text-secondary">Physical strength, force, grappling.</p></Card>
                    <Card aosDelay="150"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Endurance</h4><p className="text-text-secondary">Stamina, resistance to pain, wound thresholds.</p></Card>
                    <Card aosDelay="200"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Agility</h4><p className="text-text-secondary">Speed, balance, accuracy, dodging.</p></Card>
                    <Card aosDelay="250"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Intellect</h4><p className="text-text-secondary">Logic, science, technical knowledge.</p></Card>
                    <Card aosDelay="300"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Willpower</h4><p className="text-text-secondary">Focus, mental resilience, Etherialist stability.</p></Card>
                    <Card aosDelay="350"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Awareness</h4><p className="text-text-secondary">Perception, spatial awareness, reaction timing.</p></Card>
                     <Card className="md:col-span-2 lg:col-span-1" aosDelay="400"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Presence</h4><p className="text-text-secondary">Charm, leadership, negotiation, social impact.</p></Card>
                </div>
                 <h3 className="text-2xl font-semibold mb-4 text-accent-cyan-light">Skills</h3>
                 <p className="mb-6 text-text-secondary">Skills represent specific training or aptitudes. They are ranked from 1-12 (potentially higher). The cost to increase skills depends on the current rank:</p>
                <Card className="mb-12" aosDelay="100">
                     <ul className="list-disc list-inside text-text-secondary space-y-1">
                         <li>Ranks 1–4: 1 XP per rank</li>
                         <li>Ranks 5–8: 2 XP per rank</li>
                         <li>Ranks 9–12: 3 XP per rank</li>
                     </ul>
                     <p className="mt-3 text-sm text-text-muted italic">Note: The PDF mentions specific skills like Martial Acumen, Pistols, Long Gun, Unarmed, Engineering, Medicine, Negotiation, Business, Aeronautics, Battle Composure but doesn't provide a comprehensive list.</p>
                 </Card>
                <h3 className="text-2xl font-semibold mb-4 text-accent-cyan-light">Making Checks</h3>
                 <Card className="mb-6" aosDelay="100">
                    <p className="text-text-secondary leading-relaxed">When attempting an action where the outcome is uncertain, you typically make a check. The core formula is:</p>
                    {/* Updated check formula styling */}
                    <p className="my-3 p-3 bg-content-dark rounded text-center font-mono text-accent-cyan-light text-lg">Roll 2d6 + Skill Rank + Attribute Modifier</p>
                    <p className="text-text-secondary leading-relaxed">This total is compared against a Target Number (TN) set by the Game Master (GM) based on difficulty, or against an opponent's check result in an opposed check.</p>
                </Card>
                 <Card aosDelay="200">
                     <h4 className="font-semibold text-xl text-accent-cyan mb-2">Opposed Checks</h4>
                    <p className="text-text-secondary leading-relaxed">When two characters are directly competing (e.g., attacking vs. defending, sneaking vs. detecting), both make a relevant check. The character with the higher result succeeds. Ties often favour the defender or result in a stalemate, depending on the situation.</p>
                 </Card>
            </div>
        );

        const CombatPage = () => {
            // State variables remain the same
            const [charAttackerSkill, setCharAttackerSkill] = useState(5);
            const [charAttackerAttribute, setCharAttackerAttribute] = useState(6);
            const [charAttackerMight, setCharAttackerMight] = useState(6);
            const [charWeaponDamage, setCharWeaponDamage] = useState(4);
            const [charAttackerMods, setCharAttackerMods] = useState(0);
            const [charDefenderAgility, setCharDefenderAgility] = useState(5);
            const [charDefenderBonus, setCharDefenderBonus] = useState(1);
            const [charDefenderSoak, setCharDefenderSoak] = useState(2);
            const [charCombatResult, setCharCombatResult] = useState(null);
            const [shipGunnery, setShipGunnery] = useState(4);
            const [shipOfficerMod, setShipOfficerMod] = useState(1);
            const [shipAttackBonus, setShipAttackBonus] = useState(1);
            const [shipCannonDamage, setShipCannonDamage] = useState(10);
            const [shipPowerBonus, setShipPowerBonus] = useState(2);
            const [shipAttackMods, setShipAttackMods] = useState(0);
            const [shipPilotMod, setShipPilotMod] = useState(1);
            const [shipDefenseBonus, setShipDefenseBonus] = useState(1);
            const [shipArmor, setShipArmor] = useState(5);
            const [shipCoverBonus, setShipCoverBonus] = useState(0);
            const [shipCombatResult, setShipCombatResult] = useState(null);

            // Calculation functions remain the same
            const calculateCharacterCombat = useCallback(() => {
                const attackerAttrMod = getAttributeModifier(charAttackerAttribute);
                const attackerMightMod = getAttributeModifier(charAttackerMight);
                const defenderAgiMod = getAttributeModifier(charDefenderAgility);
                const diceRoll = roll2d6();
                const attackTotal = diceRoll.total + charAttackerSkill + attackerAttrMod + charAttackerMods;
                const defenseTN = 8 + defenderAgiMod + charDefenderBonus;
                const hit = attackTotal >= defenseTN;
                const damageDealt = hit ? Math.max(0, charWeaponDamage + attackerMightMod - charDefenderSoak) : 0;
                setCharCombatResult({ diceRoll, attackTotal, defenseTN, hit, damageDealt, attackerAttrMod, attackerMightMod, defenderAgiMod });
            }, [charAttackerSkill, charAttackerAttribute, charAttackerMight, charWeaponDamage, charAttackerMods, charDefenderAgility, charDefenderBonus, charDefenderSoak]);

            const calculateAirshipCombat = useCallback(() => {
                const diceRoll = roll2d6();
                const attackTotal = diceRoll.total + shipGunnery + shipOfficerMod + shipAttackBonus + shipAttackMods;
                const defenseTN = 8 + shipPilotMod + shipDefenseBonus + shipCoverBonus; // Assuming base 8
                const hit = attackTotal >= defenseTN;
                const damageDealt = hit ? Math.max(0, shipCannonDamage + shipPowerBonus - shipArmor) : 0;
                setShipCombatResult({ diceRoll, attackTotal, defenseTN, hit, damageDealt });
            }, [shipGunnery, shipOfficerMod, shipAttackBonus, shipCannonDamage, shipPowerBonus, shipAttackMods, shipPilotMod, shipDefenseBonus, shipArmor, shipCoverBonus]);

            // JSX structure remains similar, just updated colors/styles
            return (
                <div data-aos="fade-in">
                    <SectionHeading>Combat</SectionHeading>
                    <p className="text-lg mb-8 text-text-secondary leading-relaxed">
                        Conflict is inevitable in the skies. Combat follows the core mechanic of opposed checks, with specific rules for attacks, defense, and damage.
                    </p>
                    <h3 className="text-2xl font-semibold mb-4 text-accent-cyan-light">Character Combat</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                         {/* Updated card text/heading colors */}
                         <Card aosDelay="100">
                            <h4 className="font-semibold text-xl text-accent-cyan mb-2">Attacking</h4>
                            <p className="text-text-secondary">Make an opposed check:</p>
                            <p className="my-2 p-2 bg-content-dark rounded text-center font-mono text-sm">Attacker: 2d6 + Combat Skill + Attr Mod + Other Mods</p>
                            <p className="text-text-secondary">vs.</p>
                            <p className="my-2 p-2 bg-content-dark rounded text-center font-mono text-sm">Defender: Defense TN</p>
                             <p className="text-text-muted text-xs mt-2">Relevant attribute is usually Agility for ranged/finesse, Might for heavy melee.</p>
                        </Card>
                         <Card aosDelay="150">
                            <h4 className="font-semibold text-xl text-accent-cyan mb-2">Defense</h4>
                            <p className="text-text-secondary">Your base Defense Target Number (TN) is:</p>
                             <p className="my-2 p-2 bg-content-dark rounded text-center font-mono text-lg">8 + Agility Mod + Armor/Cover Bonus</p>
                             <p className="text-text-muted text-xs mt-2">Actions like "Defend" can temporarily increase this TN.</p>
                         </Card>
                         <Card aosDelay="200">
                            <h4 className="font-semibold text-xl text-accent-cyan mb-2">Damage</h4>
                            <p className="text-text-secondary">If an attack hits, damage is calculated as:</p>
                             <p className="my-2 p-2 bg-content-dark rounded text-center font-mono text-lg">Weapon Damage + Might Mod - Target's Armor Soak</p>
                             <p className="text-text-muted text-xs mt-2">Damage cannot be reduced below 0. Armor provides Soak based on its type.</p>
                         </Card>
                         <Card aosDelay="250">
                            <h4 className="font-semibold text-xl text-accent-cyan mb-2">Wounds & Endurance</h4>
                            <p className="text-text-secondary">Characters have wound thresholds based on Endurance. Exceeding these thresholds imposes penalties or incapacitation. Trauma and recovery are also influenced by Endurance and Med Bay upgrades.</p>
                         </Card>
                    </div>
                    <Card className="mb-12" aosDelay="100">
                        <h4 className="text-xl font-semibold mb-4 text-accent-cyan-light">Character Combat Calculator</h4>
                         <div className="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                            <div className="space-y-3">
                                <h5 className="text-lg font-medium text-accent-cyan border-b border-accent-amber/50 pb-1 mb-2">Attacker</h5>
                                <CalculatorInput id="char-skill" label="Combat Skill (0-12)" value={charAttackerSkill} onChange={(e) => setCharAttackerSkill(Number(e.target.value))} min="0" max="12"/>
                                <CalculatorInput id="char-attr" label="Relevant Attr (1-10)" value={charAttackerAttribute} onChange={(e) => setCharAttackerAttribute(Number(e.target.value))} min="1" max="10"/>
                                <CalculatorInput id="char-might" label="Attacker Might (1-10, for Dmg)" value={charAttackerMight} onChange={(e) => setCharAttackerMight(Number(e.target.value))} min="1" max="10"/>
                                <CalculatorInput id="char-wpn-dmg" label="Weapon Damage" value={charWeaponDamage} onChange={(e) => setCharWeaponDamage(Number(e.target.value))} min="0"/>
                                <CalculatorInput id="char-atk-mods" label="Other Mods (+/-)" value={charAttackerMods} onChange={(e) => setCharAttackerMods(Number(e.target.value))}/>
                            </div>
                             <div className="space-y-3">
                                 <h5 className="text-lg font-medium text-accent-cyan border-b border-accent-amber/50 pb-1 mb-2">Defender</h5>
                                 <CalculatorInput id="char-def-agi" label="Defender Agility (1-10)" value={charDefenderAgility} onChange={(e) => setCharDefenderAgility(Number(e.target.value))} min="1" max="10"/>
                                 <CalculatorInput id="char-def-bonus" label="Armor/Cover Bonus" value={charDefenderBonus} onChange={(e) => setCharDefenderBonus(Number(e.target.value))} min="0"/>
                                 <CalculatorInput id="char-def-soak" label="Armor Soak" value={charDefenderSoak} onChange={(e) => setCharDefenderSoak(Number(e.target.value))} min="0"/>
                            </div>
                        </div>
                        <div className="mt-6 text-center">
                            <CalculatorButton onClick={calculateCharacterCombat}>Calculate Character Roll</CalculatorButton>
                        </div>
                        {charCombatResult && (
                            <ResultBox>
                                <p><strong>Dice Roll (2d6):</strong> {charCombatResult.diceRoll.total} ({charCombatResult.diceRoll.rolls.join(' + ')})</p>
                                <p><strong>Attacker's Check:</strong> {charCombatResult.diceRoll.total} + {charAttackerSkill}(Skill) + {charCombatResult.attackerAttrMod}(Attr) + {charAttackerMods}(Mods) = <strong>{charCombatResult.attackTotal}</strong></p>
                                <p><strong>Defender's Defense TN:</strong> 8 + {charCombatResult.defenderAgiMod}(Agi) + {charDefenderBonus}(Bonus) = <strong>{charCombatResult.defenseTN}</strong></p>
                                <hr className="border-content-light my-1"/>
                                <p><strong>Result:</strong> {charCombatResult.hit ? <span className="text-green-400 font-bold">HIT!</span> : <span className="text-yellow-400 font-bold">MISS!</span>}</p>
                                {charCombatResult.hit && (
                                    <p><strong>Damage:</strong> {charWeaponDamage}(Wpn) + {charCombatResult.attackerMightMod}(Might) - {charDefenderSoak}(Soak) = <strong className="text-xl text-accent-cyan-light">{charCombatResult.damageDealt} Damage</strong></p>
                                )}
                                 <p className="text-xs text-text-muted mt-1">*Attr Mod = Attr - 5</p>
                            </ResultBox>
                        )}
                    </Card>
                    <h3 className="text-2xl font-semibold mb-4 text-accent-cyan-light mt-12">Airship Combat</h3>
                     <div className="disclaimer mb-6 !ml-0 !pl-3 !mt-0">
                        Note: Specific airship combat mechanics are not detailed in the draft. The following rules and calculator are plausible interpretations.
                    </div>
                     <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                         <Card aosDelay="100">
                            <h4 className="font-semibold text-xl text-accent-cyan mb-2">Attacking (Estimated)</h4>
                            <p className="text-text-secondary">Likely involves an opposed check using Gunnery skills, officer modifiers, and ship systems (like targeting arrays).</p>
                             <p className="my-2 p-2 bg-content-dark rounded text-center font-mono text-sm">Est: 2d6 + Gunnery + Officer Mod + System Bonus vs. Target Defense TN</p>
                         </Card>
                         <Card aosDelay="150">
                            <h4 className="font-semibold text-xl text-accent-cyan mb-2">Defense (Estimated)</h4>
                            <p className="text-text-secondary">Probably involves a base TN modified by the pilot's skill/modifiers, ship evasion systems, and potentially cover (like clouds).</p>
                            <p className="my-2 p-2 bg-content-dark rounded text-center font-mono text-sm">Est. TN: 8 + Pilot Mod + System Bonus + Cover</p>
                         </Card>
                         <Card aosDelay="200">
                            <h4 className="font-semibold text-xl text-accent-cyan mb-2">Damage (Estimated)</h4>
                            <p className="text-text-secondary">Cannon damage, likely boosted by Power Crystal levels, reduced by the target ship's Armor or Shield systems.</p>
                            <p className="my-2 p-2 bg-content-dark rounded text-center font-mono text-sm">Est: Cannon Dmg + Power Bonus - Target Armor</p>
                         </Card>
                         <Card aosDelay="250">
                            <h4 className="font-semibold text-xl text-accent-cyan mb-2">Targeting Systems</h4>
                            <p className="text-text-secondary">Hits might target specific ship systems (Engines, Weapons, Lift Crystal) causing critical effects beyond simple hull damage.</p>
                         </Card>
                    </div>
                     <Card aosDelay="100">
                         <h4 className="text-xl font-semibold mb-4 text-accent-cyan-light">Airship Combat Calculator (Estimated)</h4>
                         <div className="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                            <div className="space-y-3">
                                <h5 className="text-lg font-medium text-accent-cyan border-b border-accent-amber/50 pb-1 mb-2">Attacking Ship</h5>
                                <CalculatorInput id="ship-gunnery" label="Gunnery Skill/Bonus" value={shipGunnery} onChange={(e) => setShipGunnery(Number(e.target.value))} min="0"/>
                                <CalculatorInput id="ship-officer-mod" label="Officer Modifier" value={shipOfficerMod} onChange={(e) => setShipOfficerMod(Number(e.target.value))}/>
                                <CalculatorInput id="ship-atk-bonus" label="System Attack Bonus" value={shipAttackBonus} onChange={(e) => setShipAttackBonus(Number(e.target.value))} min="0"/>
                                <CalculatorInput id="ship-cannon-dmg" label="Cannon Damage" value={shipCannonDamage} onChange={(e) => setShipCannonDamage(Number(e.target.value))} min="0"/>
                                <CalculatorInput id="ship-power-bonus" label="Power Crystal Dmg Bonus" value={shipPowerBonus} onChange={(e) => setShipPowerBonus(Number(e.target.value))} min="0"/>
                                <CalculatorInput id="ship-atk-mods" label="Other Attack Mods (+/-)" value={shipAttackMods} onChange={(e) => setShipAttackMods(Number(e.target.value))}/>
                            </div>
                            <div className="space-y-3">
                                 <h5 className="text-lg font-medium text-accent-cyan border-b border-accent-amber/50 pb-1 mb-2">Defending Ship</h5>
                                 <CalculatorInput id="ship-pilot-mod" label="Pilot Modifier" value={shipPilotMod} onChange={(e) => setShipPilotMod(Number(e.target.value))}/>
                                 <CalculatorInput id="ship-def-bonus" label="System Defense Bonus" value={shipDefenseBonus} onChange={(e) => setShipDefenseBonus(Number(e.target.value))} min="0"/>
                                 <CalculatorInput id="ship-armor" label="Ship Armor/Shields" value={shipArmor} onChange={(e) => setShipArmor(Number(e.target.value))} min="0"/>
                                 <CalculatorInput id="ship-cover" label="Cover Bonus" value={shipCoverBonus} onChange={(e) => setShipCoverBonus(Number(e.target.value))} min="0"/>
                            </div>
                         </div>
                         <div className="mt-6 text-center">
                            <CalculatorButton onClick={calculateAirshipCombat}>Calculate Airship Roll</CalculatorButton>
                         </div>
                         {shipCombatResult && (
                            <ResultBox>
                                <p><strong>Dice Roll (2d6):</strong> {shipCombatResult.diceRoll.total} ({shipCombatResult.diceRoll.rolls.join(' + ')})</p>
                                <p><strong>Attacking Ship Check:</strong> {shipCombatResult.diceRoll.total} + {shipGunnery}(Gun) + {shipOfficerMod}(Off) + {shipAttackBonus}(Sys) + {shipAttackMods}(Oth) = <strong>{shipCombatResult.attackTotal}</strong></p>
                                <p><strong>Defending Ship TN:</strong> 8 + {shipPilotMod}(Pilot) + {shipDefenseBonus}(Sys) + {shipCoverBonus}(Cov) = <strong>{shipCombatResult.defenseTN}</strong></p>
                                <hr className="border-content-light my-1"/>
                                <p><strong>Result:</strong> {shipCombatResult.hit ? <span className="text-green-400 font-bold">HIT!</span> : <span className="text-yellow-400 font-bold">MISS!</span>}</p>
                                {shipCombatResult.hit && (
                                    <p><strong>Damage:</strong> {shipCannonDamage}(Cannon) + {shipPowerBonus}(Power) - {shipArmor}(Armor) = <strong className="text-xl text-accent-cyan-light">{shipCombatResult.damageDealt} Damage</strong></p>
                                )}
                                <p className="text-xs text-text-muted mt-1">*Mechanics estimated.</p>
                            </ResultBox>
                         )}
                     </Card>
                </div>
            );
        };

        const ArchetypesPage = () => (
             <div data-aos="fade-in">
                <SectionHeading>Starting Archetypes</SectionHeading>
                <p className="text-lg mb-8 text-text-secondary leading-relaxed">
                    Choose a starting archetype that defines your character's background, initial skills, and role within the Cinder Spires world.
                </p>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                     <Card className="flex flex-col" aosDelay="100">
                         <ImageWithFallback
                            src="images/archtype-SpirearchsGuard.png" // <-- Changed to relative path
                            //src="https://placehold.co/400x250/1f2937/6b7280?text=Spirearch's+Guard+Concept"
                            alt="Concept art for a Spirearch's Guard in uniform."
                            className="w-full h-40 rounded-t-lg mb-4"
                            fallbackText="Guard Concept"
                        />
                        <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Spirearch's Guard</h3>
                        <p className="text-text-muted mb-4 italic">"We are warriors, not thugs..."</p>
                        <p className="text-text-secondary flex-grow">Formal, precise, and unyielding defenders trained in discipline and swordsmanship. They serve the ruling powers as elite soldiers, bodyguards, duelists, or even political instruments.</p>
                        <p className="mt-4 text-sm text-accent-cyan font-semibold">Required Skills: Unarmed, Martial Acumen</p>
                    </Card>
                     <Card className="flex flex-col" aosDelay="150">
                         <ImageWithFallback
                            src="https://placehold.co/400x250/1f2937/6b7280?text=Fleet+Marine+Concept"
                            alt="Concept art for a Fleet Marine ready for action."
                            className="w-full h-40 rounded-t-lg mb-4"
                            fallbackText="Marine Concept"
                        />
                        <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Fleet Marines</h3>
                        <p className="text-text-muted mb-4 italic">"Marines don't ask why..."</p>
                        <p className="text-text-secondary flex-grow">Hardened airship enforcers and boarding troops, often serving aboard naval vessels or merchant ships needing protection. Known for their grit and practical combat skills.</p>
                         <p className="mt-4 text-sm text-accent-cyan font-semibold">Required Skills: Long Gun, Battle Composure</p>
                   </Card>
                     <Card className="flex flex-col" aosDelay="200">
                         <ImageWithFallback
                            src="https://placehold.co/400x250/1f2937/6b7280?text=Scholar+Concept"
                            alt="Concept art for a Scholar studying ancient texts or devices."
                            className="w-full h-40 rounded-t-lg mb-4"
                            fallbackText="Scholar Concept"
                        />
                        <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Scholars</h3>
                        <p className="text-text-muted mb-4 italic">"Knowledge is the only defense..."</p>
                        <p className="text-text-secondary flex-grow">Keepers of knowledge, sacred and scientific. Researchers, engineers, medics, or field archaeologists pursuing understanding in a world often hostile to it.</p>
                         <p className="mt-4 text-sm text-accent-cyan font-semibold">Required Skills: Engineering, Medicine</p>
                   </Card>
                     <Card className="flex flex-col" aosDelay="250">
                         <ImageWithFallback
                            src="https://placehold.co/400x250/1f2937/6b7280?text=Merchant+Concept"
                            alt="Concept art for a Merchant negotiating a deal."
                            className="w-full h-40 rounded-t-lg mb-4"
                            fallbackText="Merchant Concept"
                        />
                        <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Merchants</h3>
                        <p className="text-text-muted mb-4 italic">"No one is loyal to coin..."</p>
                        <p className="text-text-secondary flex-grow">Brokers of influence, masters of leverage, and navigators of risk. They thrive on trade, information, and social maneuvering, knowing every advantage has its price.</p>
                         <p className="mt-4 text-sm text-accent-cyan font-semibold">Required Skills: Negotiation, Business</p>
                   </Card>
                     <Card className="flex flex-col" aosDelay="300">
                         <ImageWithFallback
                            src="images/archetype-Aeronaut.jpg" // <-- Changed to relative path
                            //src="https://placehold.co/400x250/1f2937/6b7280?text=Aeronaut+Concept"
                            alt="Concept art for an Aeronaut at the helm of an airship."
                            className="w-full h-40 rounded-t-lg mb-4"
                            fallbackText="Aeronaut Concept"
                        />
                        <h3 className="text-2xl font-semibold mb-3 text-accent-cyan-light">Aeronauts</h3>
                        <p className="text-text-muted mb-4 italic">"...his own heart raced..."</p>
                        <p className="text-text-secondary flex-grow">Living on the edge of storm and steel, aeronauts are the quintessential airship crew. Pilots, navigators, gunners, or daredevil riggers, part warrior, part wanderer.</p>
                         <p className="mt-4 text-sm text-accent-cyan font-semibold">Required Skills: Aeronautics, Pistols</p>
                   </Card>
                </div>
            </div>
        );

        const ShipsPage = () => (
            <div data-aos="fade-in">
                <SectionHeading>Ships & Crew</SectionHeading>
                <p className="text-lg mb-8 text-text-secondary leading-relaxed">
                    Your airship is more than transport; it's your base, your weapon, and your home. Maintaining and upgrading the ship and crew is vital for survival and success.
                </p>
                <h3 className="text-2xl font-semibold mb-4 text-accent-cyan-light">Upgradable Ship Areas</h3>
                <p className="mb-6 text-text-secondary">These areas can be upgraded during downtime, providing passive or active benefits to the crew.</p>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
                    {/* Add simple icons or small images if desired */}
                    <Card aosDelay="100"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Armory</h4><p className="text-text-secondary">Improved starting equipment for replacement characters.</p></Card>
                    <Card aosDelay="150"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Med Bay</h4><p className="text-text-secondary">Faster wound recovery and trauma stabilization.</p></Card>
                    <Card aosDelay="200"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Crew Quarters</h4><p className="text-text-secondary">Boost to XP gain for Intellect-based skills.</p></Card>
                    <Card aosDelay="250"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Engineering Bay</h4><p className="text-text-secondary">Faster repairs/upgrades; may reduce Engineer TNs.</p></Card>
                    <Card aosDelay="300"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Crew Lounge</h4><p className="text-text-secondary">Boost to XP gain for Presence-based and merchant skills.</p></Card>
                    <Card aosDelay="350"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Training Deck</h4><p className="text-text-secondary">Boost to XP gain for combat-related skills.</p></Card>
                    <Card aosDelay="400"><h4 className="font-semibold text-xl text-accent-cyan mb-1">Cargo Hold</h4><p className="text-text-secondary">Generates downtime income or rare upgrade materials.</p></Card>
                </div>
                <h3 className="text-2xl font-semibold mb-4 text-accent-cyan-light">Upgradable Ship Systems</h3>
                <p className="mb-6 text-text-secondary">These mechanical systems can be upgraded between missions or after acquiring sufficient resources.</p>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                     <Card aosDelay="100">
                         <ImageWithFallback
                            src="https://placehold.co/300x150/111827/6b7280?text=Glowing+Power+Crystal"
                            alt="Illustration of a large, glowing power crystal."
                            className="w-full h-24 rounded-t-lg mb-4"
                            fallbackText="Power Crystal"
                         />
                        <h4 className="font-semibold text-xl text-accent-cyan mb-1">Power Crystal</h4>
                        <p className="text-text-secondary">Increases energy capacity and acceleration. Determines the max allowable cannon and lift upgrades.</p>
                    </Card>
                     <Card aosDelay="150">
                         <ImageWithFallback
                            src="https://placehold.co/300x150/111827/6b7280?text=Lift+Crystal+Array"
                            alt="Illustration of smaller lift crystals arranged in an array."
                            className="w-full h-24 rounded-t-lg mb-4"
                            fallbackText="Lift Crystal"
                         />
                        <h4 className="font-semibold text-xl text-accent-cyan mb-1">Lift Crystal</h4>
                        <p className="text-text-secondary">Improves climb and dive rates. Upgraded 1:1 with Power Crystal rating.</p>
                    </Card>
                     <Card aosDelay="200">
                         <ImageWithFallback
                            src="https://placehold.co/300x150/111827/6b7280?text=Airship+Cannon+Deck"
                            alt="Illustration of cannons mounted on an airship deck."
                            className="w-full h-24 rounded-t-lg mb-4"
                            fallbackText="Cannons"
                         />
                        <h4 className="font-semibold text-xl text-accent-cyan mb-1">Cannons</h4>
                        <p className="text-text-secondary">Upgrade chase or broadside weapons within caps determined by Power Crystal rating.</p>
                    </Card>
                </div>
                <h3 className="text-2xl font-semibold mb-4 text-accent-cyan-light">Crew Strength & Replacement</h3>
                 <Card aosDelay="100">
                    <p className="text-text-secondary leading-relaxed mb-3">As your ship and crew gain fame and experience, your Crew Strength increases (starting at 1). This represents overall morale, capability, and survivability.</p>
                     <ul className="list-disc list-inside text-text-secondary space-y-1">
                         <li>Influenced by reputation and ship upgrades.</li>
                         <li>Determines the starting level/resources of replacement characters should a primary character fall.</li>
                         <li>Impacts the cost of improving skills (see Mechanics page).</li>
                    </ul>
                 </Card>
            </div>
        );


        // --- Header Component ---
        const Header = ({ currentPage, setCurrentPage }) => {
            const NavLink = ({ page, children }) => (
                <button
                    onClick={() => setCurrentPage(page)}
                    // Use template literal for conditional class application
                    className={`px-3 py-2 rounded transition duration-300 ${currentPage === page ? 'nav-link-active' : 'nav-link-inactive'}`}
                >
                    {children}
                </button>
            );

            return (
                // Updated header background
                <header className="sticky top-0 z-50 w-full shadow-md backdrop-blur-md bg-content-dark/80 border-b border-accent-amber/30">
                    <nav className="container mx-auto px-4 sm:px-6 py-3 flex flex-wrap justify-between items-center">
                        {/* Updated title color */}
                        <h1 className="text-2xl font-bold text-accent-cyan-light mr-6 cursor-pointer" onClick={() => setCurrentPage('home')}>
                            The Cinder Spires
                        </h1>
                        <div className="space-x-1 sm:space-x-2 text-sm md:text-base">
                            <NavLink page="home">Home</NavLink>
                            <NavLink page="world">World</NavLink>
                            <NavLink page="mechanics">Mechanics</NavLink>
                            <NavLink page="combat">Combat</NavLink>
                            <NavLink page="archetypes">Archetypes</NavLink>
                            <NavLink page="ships">Ships & Crew</NavLink>
                        </div>
                    </nav>
                </header>
            );
        };

        // --- Footer Component ---
        const Footer = () => (
            // Updated footer background and border
            <footer className="bg-content-dark py-6 mt-16 border-t border-accent-amber/30">
                <div className="container mx-auto px-6 text-center text-text-muted text-sm">
                    &copy; {new Date().getFullYear()} The Cinder Spires RPG. Content based on Draft 1.2.
                </div>
            </footer>
        );

        // --- Main App Component ---
        function App() {
            const [currentPage, setCurrentPage] = useState('home');

            useEffect(() => {
                if (typeof AOS !== 'undefined') {
                    AOS.init({ once: true, duration: 600, easing: 'ease-in-out' });
                } else { console.warn("AOS library not found."); }
            }, []);

             useEffect(() => {
                 if (typeof AOS !== 'undefined') { setTimeout(() => AOS.refresh(), 100); }
                 window.scrollTo(0, 0);
            }, [currentPage]);

            const renderPage = () => {
                switch (currentPage) {
                    case 'world': return React.createElement(WorldPage);
                    case 'mechanics': return React.createElement(MechanicsPage);
                    case 'combat': return React.createElement(CombatPage);
                    case 'archetypes': return React.createElement(ArchetypesPage);
                    case 'ships': return React.createElement(ShipsPage);
                    case 'home': default: return React.createElement(HomePage, { setCurrentPage: setCurrentPage });
                }
            };

            return (
                 React.createElement(Fragment, null,
                    React.createElement(Header, { currentPage: currentPage, setCurrentPage: setCurrentPage }),
                    React.createElement("main", { className: "container mx-auto px-4 sm:px-6 py-12 min-h-screen" }, renderPage()),
                    React.createElement(Footer, null)
                 )
            );
        }

        // --- Render the App to the DOM ---
        const container = document.getElementById('root');
        if (container) {
             const root = ReactDOM.createRoot(container);
             root.render(React.createElement(App));
        } else { console.error("Root element with ID 'root' not found."); }

    </script>
</body>
</html>
